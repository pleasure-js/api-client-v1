/*!
 * @pleasure-js/api-client v1.0.0
 * (c) 2018-2020 Martin Rafael Gonzalez <tin@devtin.io>
 * Released under the MIT License.
 */
var PleasureApiClient=function(e,t,n,o){'use strict';var ke=Math.floor,je=String.prototype,xe=String.fromCharCode;function r(){return{appURL:"http://localhost:3000",apiURL:`${"http://localhost:3000"}${"/api"}`,entitiesUri:"/entities",authEndpoint:"/token",revokeEndpoint:"/revoke",timeout:15e3}}function i(e,t){return t={exports:{}},e(t,t.exports),t.exports}function s(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_t&&_t in Object(e)?mt(e):bt(e)}function a(e,t){if(nt(e))return!1;var n=typeof e;return!!("number"==n||"symbol"==n||"boolean"==n||null==e||xt(e))||Ot.test(e)||!vt.test(e)||null!=t&&e in Object(t)}function d(e){return!!Pt&&Pt in e}function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function p(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var s=e.apply(this,o);return n.cache=i.set(r,s)||i,s};return n.cache=new(p.Cache||an),n}function h(e){if("string"==typeof e)return e;if(nt(e))return un(e,h)+"";if(xt(e))return fn?fn.call(e):"";var t=e+"";return"0"==t&&1/e==-pn?"-0":t}function f({apiURL:e=kn.apiURL,timeout:n=kn.timeout}={}){const o=t.create({timeout:n,baseURL:e,paramsSerializer(e){return et.stringify(e,{arrayFormat:"brackets"})},headers:{"X-Pleasure-Client":"1.0.0"}});return o.interceptors.response.use(e=>{const{data:{statusCode:t,data:n,error:o,message:r}}=e||{};if(200===t)return n;throw new ve(o,r,t,n)},e=>{const{errors:t,error:n}=_n(e,"response.data",{});throw new Error(n||"Unknown error")}),o}function m(e){var t=this.__data__=new tn(e);this.size=t.size}function y(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new an;++t<n;)this.add(e[t])}function g(e,t,n,o,r,i){var s=1&n,a=ar(e),d=a.length,l=ar(t),c=l.length;if(d!=c&&!s)return!1;for(var u,p=d;p--;)if(u=a[p],s?!(u in t):!lr.call(t,u))return!1;var h=i.get(e);if(h&&i.get(t))return h==t;var f=!0;i.set(e,t),i.set(t,e);for(var m=s;++p<d;){u=a[p];var y=e[u],g=t[u];if(o)var b=s?o(g,y,u,t,e,i):o(y,g,u,e,t,i);if(void 0===b?!(y===g||r(y,g,n,o,i)):!b){f=!1;break}m||(m="constructor"==u)}if(f&&!m){var _=e.constructor,k=t.constructor;_!=k&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof k&&k instanceof k)&&(f=!1)}return i["delete"](e),i["delete"](t),f}function b(e,t,n,o,r){return e===t||(null!=e&&null!=t&&(jt(e)||jt(t))?Tr(e,t,n,o,b,r):e!==e&&t!==t)}function _(e,t,n,o){var r=n.length,i=r,s=!o;if(null==e)return!i;for(e=Object(e);r--;){var a=n[r];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++r<i;){a=n[r];var d=a[0],l=e[d],c=a[1];if(!(s&&a[2])){var u=new Bo;if(o)var p=o(l,c,d,e,t,u);if(void 0===p?!zr(c,l,3,o,u):!p)return!1}else if(void 0===l&&!(d in e))return!1}return!0}function k(e,t){return null!=e&&t in Object(e)}function j(e){this.message=e}function x(e){return decodeURIComponent($r(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return 2>n.length&&(n="0"+n),"%"+n}))}function v(e){this.message=e}function O(){}function w(){w.init.call(this)}function A(e){return void 0===e._maxListeners?w.defaultMaxListeners:e._maxListeners}function L(e,t,n){if(t)e.call(n);else for(var o=e.length,r=U(e,o),s=0;s<o;++s)r[s].call(n)}function C(e,t,n,o){if(t)e.call(n,o);else for(var r=e.length,s=U(e,r),a=0;a<r;++a)s[a].call(n,o)}function E(e,t,n,o,r){if(t)e.call(n,o,r);else for(var s=e.length,a=U(e,s),d=0;d<s;++d)a[d].call(n,o,r)}function P(e,t,n,o,r,s){if(t)e.call(n,o,r,s);else for(var a=e.length,d=U(e,a),l=0;l<a;++l)d[l].call(n,o,r,s)}function S(e,t,n,o){if(t)e.apply(n,o);else for(var r=e.length,s=U(e,r),a=0;a<r;++a)s[a].apply(n,o)}function T(e,t,n,o){var r,i,s;if("function"!=typeof n)throw new TypeError("\"listener\" argument must be a function");if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]):(i=e._events=new O,e._eventsCount=0),!s)s=i[t]=n,++e._eventsCount;else if("function"==typeof s?s=i[t]=o?[n,s]:[s,n]:o?s.unshift(n):s.push(n),!s.warned&&(r=A(e),r&&0<r&&s.length>r)){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,z(a)}return e}function z(t){"function"==typeof console.warn?console.warn(t):console.log(t)}function D(e,t,n){function o(){e.removeListener(t,o),r||(r=!0,n.apply(e,arguments))}var r=!1;return o.listener=n,o}function N(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function I(e,t){for(var o=t,r=o+1,s=e.length;r<s;o+=1,r+=1)e[o]=e[r];e.pop()}function U(e,t){for(var n=Array(t);t--;)n[t]=e[t];return n}function q(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function R(e){return!!e&&"object"==typeof e}function M(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||F(e)}function F(e){return e.$$typeof===Yr}function H(e){return Array.isArray(e)?[]:{}}function B(e,t){return!1!==t.clone&&t.isMergeableObject(e)?J(H(e),e,t):e}function V(e,t,n){return e.concat(t).map(function(e){return B(e,n)})}function Q(e,t){if(!t.customMerge)return J;var n=t.customMerge(e);return"function"==typeof n?n:J}function $(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return e.propertyIsEnumerable(t)}):[]}function G(e){return Object.keys(e).concat($(e))}function W(e,t){try{return t in e}catch(e){return!1}}function Z(e,t){return W(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function K(e,t,n){var o={};return n.isMergeableObject(e)&&G(e).forEach(function(t){o[t]=B(e[t],n)}),G(t).forEach(function(r){Z(e,r)||(W(e,r)&&n.isMergeableObject(t[r])?o[r]=Q(r,n)(e[r],t[r],n):o[r]=B(t[r],n))}),o}function J(e,t,n){n=n||{},n.arrayMerge=n.arrayMerge||V,n.isMergeableObject=n.isMergeableObject||Kr,n.cloneUnlessOtherwiseSpecified=B;var o=Array.isArray(t),r=Array.isArray(e);return o===r?o?n.arrayMerge(e,t,n):K(e,t,n):B(t,n)}function Y(e){throw new RangeError(ti[e])}function X(e,t){for(var n=e.length,o=[];n--;)o[n]=t(e[n]);return o}function ee(e,t){var n=e.split("@"),o="";1<n.length&&(o=n[0]+"@",e=n[1]),e=e.replace(ei,".");var r=e.split("."),i=X(r,t).join(".");return o+i}function te(e){for(var t,n,o=[],r=0,i=e.length;r<i;)t=e.charCodeAt(r++),55296<=t&&56319>=t&&r<i?(n=e.charCodeAt(r++),56320==(64512&n)?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),r--)):o.push(t);return o}function ne(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function oe(e,t,n){var o=0;for(e=n?ni(e/700):e>>1,e+=ni(e/t);455<e;o+=36)e=ni(e/35);return ni(o+36*e/(e+38))}function re(e){var o,r,i,s,a,d,l,c,u,p,h,f,y,g,b,_=[];for(e=te(e),f=e.length,o=128,r=0,a=72,d=0;d<f;++d)h=e[d],128>h&&_.push(oi(h));for(i=s=_.length,s&&_.push("-");i<f;){for(l=2147483647,d=0;d<f;++d)h=e[d],h>=o&&h<l&&(l=h);for(y=i+1,l-o>ni((2147483647-r)/y)&&Y("overflow"),r+=(l-o)*y,o=l,d=0;d<f;++d)if(h=e[d],h<o&&2147483647<++r&&Y("overflow"),h==o){for(c=r,u=36;;u+=36){if(p=u<=a?1:u>=a+26?26:u-a,c<p)break;b=c-p,g=36-p,_.push(oi(ne(p+b%g,0))),c=ni(b/g)}_.push(oi(ne(c,0))),a=oe(r,y,i==s),r=0,++i}++r,++o}return _.join("")}function ie(e){return ee(e,function(e){return Xr.test(e)?"xn--"+re(e):e})}function se(e){return null===e}function ae(e){return null==e}function de(e){return"string"==typeof e}function le(e){return"object"==typeof e&&null!==e}function ce(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ue(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return"";}}function pe(e,t,n,o){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?he(ii(e),function(o){var r=encodeURIComponent(ue(o))+n;return ri(e[o])?he(e[o],function(e){return r+encodeURIComponent(ue(e))}).join(t):r+encodeURIComponent(ue(e[o]))}).join(t):o?encodeURIComponent(ue(o))+n+encodeURIComponent(ue(e)):""}function he(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o++)n.push(t(e[o],o));return n}function fe(e,t,n,o){t=t||"&",n=n||"=";var r={};if("string"!=typeof e||0===e.length)return r;var s=/\+/g;e=e.split(t);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var d=e.length;0<a&&d>a&&(d=a);for(var l=0;l<d;++l){var c,u,p,h,f=e[l].replace(s,"%20"),m=f.indexOf(n);0<=m?(c=f.substr(0,m),u=f.substr(m+1)):(c=f,u=""),p=decodeURIComponent(c),h=decodeURIComponent(u),ce(r,p)?ri(r[p])?r[p].push(h):r[p]=[r[p],h]:r[p]=h}return r}function me(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function ye(e,t,n){if(e&&le(e)&&e instanceof me)return e;var o=new me;return o.parse(e,t,n),o}function ge(e,t,n,o){if(!de(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),a=-1!==r&&r<t.indexOf("#")?"?":"#",d=t.split(a),c=/\\/g;d[0]=d[0].replace(c,"/"),t=d.join(a);var u=t;if(u=u.trim(),!o&&1===t.split("#").length){var f=li.exec(u);if(f)return e.path=u,e.href=u,e.pathname=f[1],f[2]?(e.search=f[2],e.query=n?fe(e.search.substr(1)):e.search.substr(1)):n&&(e.search="",e.query={}),e}var m=ai.exec(u);if(m){m=m[0];var y=m.toLowerCase();e.protocol=y,u=u.substr(m.length)}if(o||m||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===u.substr(0,2);g&&!(m&&gi[m])&&(u=u.substr(2),e.slashes=!0)}var b,_,x,v;if(!gi[m]&&(g||m&&!bi[m])){var O=-1;for(b=0;b<hi.length;b++)_=u.indexOf(hi[b]),-1!==_&&(-1===O||_<O)&&(O=_);var w,A;for(A=-1===O?u.lastIndexOf("@"):u.lastIndexOf("@",O),-1!==A&&(w=u.slice(0,A),u=u.slice(A+1),e.auth=decodeURIComponent(w)),O=-1,b=0;b<pi.length;b++)_=u.indexOf(pi[b]),-1!==_&&(-1===O||_<O)&&(O=_);-1===O&&(O=u.length),e.host=u.slice(0,O),u=u.slice(O),_e(e),e.hostname=e.hostname||"";var L="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!L){var C=e.hostname.split(/\./);for(b=0,x=C.length;b<x;b++){var E=C[b];if(E&&!E.match(fi)){for(var P="",S=0,T=E.length;S<T;S++)P+=127<E.charCodeAt(S)?"x":E[S];if(!P.match(fi)){var k=C.slice(0,b),z=C.slice(b+1),D=E.match(mi);D&&(k.push(D[1]),z.unshift(D[2])),z.length&&(u="/"+z.join(".")+u),e.hostname=k.join(".");break}}}}e.hostname=255<e.hostname.length?"":e.hostname.toLowerCase(),L||(e.hostname=ie(e.hostname)),v=e.port?":"+e.port:"";var N=e.hostname||"";e.host=N+v,e.href+=e.host,L&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!yi[y])for(b=0,x=ui.length;b<x;b++){var h=ui[b];if(-1!==u.indexOf(h)){var I=encodeURIComponent(h);I===h&&(I=escape(h)),u=u.split(h).join(I)}}var U=u.indexOf("#");-1!==U&&(e.hash=u.substr(U),u=u.slice(0,U));var q=u.indexOf("?");if(-1===q?n&&(e.search="",e.query={}):(e.search=u.substr(q),e.query=u.substr(q+1),n&&(e.query=fe(e.query)),u=u.slice(0,q)),u&&(e.pathname=u),bi[y]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){v=e.pathname||"";var R=e.search||"";e.path=v+R}return e.href=be(e),e}function be(e){var t=e.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var n=e.protocol||"",o=e.pathname||"",r=e.hash||"",i=!1,s="";e.host?i=t+e.host:e.hostname&&(i=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(i+=":"+e.port)),e.query&&le(e.query)&&Object.keys(e.query).length&&(s=pe(e.query));var a=e.search||s&&"?"+s||"";return n&&":"!==n.substr(-1)&&(n+=":"),e.slashes||(!n||bi[n])&&!1!==i?(i="//"+(i||""),o&&"/"!==o.charAt(0)&&(o="/"+o)):!i&&(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),o=o.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),n+i+o+a+r}function _e(e){var t=e.host,n=di.exec(t);n&&(n=n[0],":"!==n&&(e.port=n.substr(1)),t=t.substr(0,t.length-n.length)),t&&(e.hostname=t)}t=t&&t.hasOwnProperty("default")?t["default"]:t,n=n&&n.hasOwnProperty("default")?n["default"]:n,o=o&&o.hasOwnProperty("default")?o["default"]:o;class ve extends Error{constructor(e,t,n=500,o){super(e),this.message=t,this.code=n,this.data=o}}var Oe=Object.prototype.hasOwnProperty,we=Array.isArray,Ae=function(){for(var e=[],t=0;256>t;++t)e.push("%"+((16>t?"0":"")+t.toString(16)).toUpperCase());return e}(),Le=function(e){for(;1<e.length;){var t=e.pop(),n=t.obj[t.prop];if(we(n)){for(var o=[],r=0;r<n.length;++r)"undefined"!=typeof n[r]&&o.push(n[r]);t.obj[t.prop]=o}}},Ce=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},o=0;o<e.length;++o)"undefined"!=typeof e[o]&&(n[o]=e[o]);return n},Ee={arrayToObject:Ce,assign:function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],o=0;o<t.length;++o)for(var r=t[o],s=r.obj[r.prop],a=Object.keys(s),d=0;d<a.length;++d){var l=a[d],c=s[l];"object"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:s,prop:l}),n.push(c))}return Le(t),e},decode:function(e,t,n){var o=e.replace(/\+/g," ");if("iso-8859-1"===n)return o.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(o)}catch(t){return o}},encode:function(e,t,n){if(0===e.length)return e;var o=e;if("symbol"==typeof e?o=Symbol.prototype.toString.call(e):"string"!=typeof e&&(o=e+""),"iso-8859-1"===n)return escape(o).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var r,s="",a=0;a<o.length;++a){if(r=o.charCodeAt(a),45===r||46===r||95===r||126===r||48<=r&&57>=r||65<=r&&90>=r||97<=r&&122>=r){s+=o.charAt(a);continue}if(128>r){s+=Ae[r];continue}if(2048>r){s+=Ae[192|r>>6]+Ae[128|63&r];continue}if(55296>r||57344<=r){s+=Ae[224|r>>12]+Ae[128|63&r>>6]+Ae[128|63&r];continue}a+=1,r=65536+((1023&r)<<10|1023&o.charCodeAt(a)),s+=Ae[240|r>>18]+Ae[128|63&r>>12]+Ae[128|63&r>>6]+Ae[128|63&r]}return s},isBuffer:function(e){return!!(e&&"object"==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,n,o){if(!n)return t;if("object"!=typeof n){if(we(t))t.push(n);else if(t&&"object"==typeof t)(o&&(o.plainObjects||o.allowPrototypes)||!Oe.call(Object.prototype,n))&&(t[n]=!0);else return[t,n];return t}if(!t||"object"!=typeof t)return[t].concat(n);var r=t;return we(t)&&!we(n)&&(r=Ce(t,o)),we(t)&&we(n)?(n.forEach(function(n,r){if(Oe.call(t,r)){var i=t[r];i&&"object"==typeof i&&n&&"object"==typeof n?t[r]=e(i,n,o):t.push(n)}else t[r]=n}),t):Object.keys(n).reduce(function(t,r){var i=n[r];return t[r]=Oe.call(t,r)?e(t[r],i,o):i,t},r)}},Pe=je.replace,Se=/%20/g,Te={RFC1738:"RFC1738",RFC3986:"RFC3986"},ze=Ee.assign({default:Te.RFC3986,formatters:{RFC1738:function(e){return Pe.call(e,Se,"+")},RFC3986:function(e){return e+""}}},Te),De=Object.prototype.hasOwnProperty,Ne={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Ie=Array.isArray,Ue=Array.prototype.push,qe=function(e,t){Ue.apply(e,Ie(t)?t:[t])},Re=Date.prototype.toISOString,Me=ze["default"],Fe={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Ee.encode,encodeValuesOnly:!1,format:Me,formatter:ze.formatters[Me],indices:!1,serializeDate:function(e){return Re.call(e)},skipNulls:!1,strictNullHandling:!1},He=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"bigint"==typeof e},Be=function e(t,n,o,r,s,a,d,l,c,u,p,h,f){var m=t;if("function"==typeof d?m=d(n,m):m instanceof Date?m=u(m):"comma"===o&&Ie(m)&&(m=m.join(",")),null===m){if(r)return a&&!h?a(n,Fe.encoder,f,"key"):n;m=""}if(He(m)||Ee.isBuffer(m)){if(a){var y=h?n:a(n,Fe.encoder,f,"key");return[p(y)+"="+p(a(m,Fe.encoder,f,"value"))]}return[p(n)+"="+p(m+"")]}var g=[];if("undefined"==typeof m)return g;var b;if(Ie(d))b=d;else{var _=Object.keys(m);b=l?_.sort(l):_}for(var k,j=0;j<b.length;++j)(k=b[j],!(s&&null===m[k]))&&(Ie(m)?qe(g,e(m[k],"function"==typeof o?o(n,k):n,o,r,s,a,d,l,c,u,p,h,f)):qe(g,e(m[k],n+(c?"."+k:"["+k+"]"),o,r,s,a,d,l,c,u,p,h,f)));return g},Ve=function(e){if(!e)return Fe;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||Fe.charset;if("undefined"!=typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=ze["default"];if("undefined"!=typeof e.format){if(!De.call(ze.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var o=ze.formatters[n],r=Fe.filter;return("function"==typeof e.filter||Ie(e.filter))&&(r=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:Fe.addQueryPrefix,allowDots:"undefined"==typeof e.allowDots?Fe.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:Fe.charsetSentinel,delimiter:"undefined"==typeof e.delimiter?Fe.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:Fe.encode,encoder:"function"==typeof e.encoder?e.encoder:Fe.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:Fe.encodeValuesOnly,filter:r,formatter:o,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:Fe.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:Fe.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:Fe.strictNullHandling}},Qe=function(e,t){var n,o,r=e,s=Ve(t);"function"==typeof s.filter?(o=s.filter,r=o("",r)):Ie(s.filter)&&(o=s.filter,n=o);var a=[];if("object"!=typeof r||null===r)return"";var d=t&&t.arrayFormat in Ne?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var l=Ne[d];n||(n=Object.keys(r)),s.sort&&n.sort(s.sort);for(var c,u=0;u<n.length;++u)(c=n[u],!(s.skipNulls&&null===r[c]))&&qe(a,Be(r[c],c,l,s.strictNullHandling,s.skipNulls,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.formatter,s.encodeValuesOnly,s.charset));var p=a.join(s.delimiter),h=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),0<p.length?h+p:""},$e=Object.prototype.hasOwnProperty,Ge=Array.isArray,We={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ee.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ze=function(e){return e.replace(/&#(\d+);/g,function(e,t){return xe(parseInt(t,10))})},Ke=function(e,t){var n,o={},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,a=r.split(t.delimiter,s),d=-1,l=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf("utf8=")&&(a[n]==="utf8=%E2%9C%93"?l="utf-8":a[n]==="utf8=%26%2310003%3B"&&(l="iso-8859-1"),d=n,n=a.length);for(n=0;n<a.length;++n)if(n!==d){var c,u,p=a[n],h=p.indexOf("]="),f=-1===h?p.indexOf("="):h+1;-1===f?(c=t.decoder(p,We.decoder,l,"key"),u=t.strictNullHandling?null:""):(c=t.decoder(p.slice(0,f),We.decoder,l,"key"),u=t.decoder(p.slice(f+1),We.decoder,l,"value")),u&&t.interpretNumericEntities&&"iso-8859-1"===l&&(u=Ze(u)),u&&"string"==typeof u&&t.comma&&-1<u.indexOf(",")&&(u=u.split(",")),-1<p.indexOf("[]=")&&(u=Ge(u)?[u]:u),o[c]=$e.call(o,c)?Ee.combine(o[c],u):u}return o},Je=function(e,t,n){for(var o=t,r=e.length-1;0<=r;--r){var s,a=e[r];if("[]"===a&&n.parseArrays)s=[].concat(o);else{s=n.plainObjects?Object.create(null):{};var d="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,l=parseInt(d,10);n.parseArrays||""!==d?!isNaN(l)&&a!==d&&l+""===d&&0<=l&&n.parseArrays&&l<=n.arrayLimit?(s=[],s[l]=o):s[d]=o:s={0:o}}o=s}return o},Ye=function(e,t,n){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,r=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,a=0<n.depth&&r.exec(o),d=a?o.slice(0,a.index):o,l=[];if(d){if(!n.plainObjects&&$e.call(Object.prototype,d)&&!n.allowPrototypes)return;l.push(d)}for(var c=0;0<n.depth&&null!==(a=s.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&$e.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(a[1])}return a&&l.push("["+o.slice(a.index)+"]"),Je(l,t,n)}},Xe=function(e){if(!e)return We;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!=typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t="undefined"==typeof e.charset?We.charset:e.charset;return{allowDots:"undefined"==typeof e.allowDots?We.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:We.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:We.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:We.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:We.comma,decoder:"function"==typeof e.decoder?e.decoder:We.decoder,delimiter:"string"==typeof e.delimiter||Ee.isRegExp(e.delimiter)?e.delimiter:We.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:We.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:We.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:We.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:We.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:We.strictNullHandling}},et={formats:ze,parse:function(e,t){var n=Xe(t);if(""===e||null===e||"undefined"==typeof e)return n.plainObjects?Object.create(null):{};for(var o="string"==typeof e?Ke(e,n):e,r=n.plainObjects?Object.create(null):{},s=Object.keys(o),a=0;a<s.length;++a){var d=s[a],l=Ye(d,o[d],n);r=Ee.merge(r,l,n)}return Ee.compact(r)},stringify:Qe},tt=Array.isArray,nt=tt,ot="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,rt="object"==typeof ot&&ot&&ot.Object===Object&&ot,it=rt,st="object"==typeof self&&self&&self.Object===Object&&self,at=it||st||Function("return this")(),dt=at,lt=dt.Symbol,ct=lt,ut=Object.prototype,pt=ut.hasOwnProperty,ht=ut.toString,ft=ct?ct.toStringTag:void 0,mt=function(e){var t=pt.call(e,ft),n=e[ft];try{e[ft]=void 0;var o=!0}catch(t){}var r=ht.call(e);return o&&(t?e[ft]=n:delete e[ft]),r},yt=Object.prototype,gt=yt.toString,bt=function(e){return gt.call(e)},_t=ct?ct.toStringTag:void 0,kt=s,jt=function(e){return null!=e&&"object"==typeof e},xt=function(e){return"symbol"==typeof e||jt(e)&&"[object Symbol]"==kt(e)},vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,wt=a,At=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Lt=function(e){if(!At(e))return!1;var t=kt(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Ct=dt["__core-js_shared__"],Et=Ct,Pt=function(){var e=/[^.]+$/.exec(Et&&Et.keys&&Et.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),St=Function.prototype,Tt=St.toString,zt=function(e){if(null!=e){try{return Tt.call(e)}catch(t){}try{return e+""}catch(t){}}return""},Dt=/[\\^$.*+?()[\]{}|]/g,Nt=/^\[object .+?Constructor\]$/,It=Function.prototype,Ut=Object.prototype,qt=It.toString,Rt=Ut.hasOwnProperty,Mt=RegExp("^"+qt.call(Rt).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ft=function(e){if(!At(e)||d(e))return!1;var t=Lt(e)?Mt:Nt;return t.test(zt(e))},Ht=function(e,t){return null==e?void 0:e[t]},Bt=function(e,t){var n=Ht(e,t);return Ft(n)?n:void 0},Vt=Bt(Object,"create"),Qt=Vt,$t=Object.prototype,Gt=$t.hasOwnProperty,Wt=Object.prototype,Zt=Wt.hasOwnProperty;l.prototype.clear=function(){this.__data__=Qt?Qt(null):{},this.size=0},l.prototype["delete"]=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},l.prototype.get=function(e){var t=this.__data__;if(Qt){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Gt.call(t,e)?t[e]:void 0},l.prototype.has=function(e){var t=this.__data__;return Qt?void 0!==t[e]:Zt.call(t,e)},l.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Qt&&void 0===t?"__lodash_hash_undefined__":t,this};var Kt=l,Jt=function(e,t){return e===t||e!==e&&t!==t},Yt=function(e,t){for(var n=e.length;n--;)if(Jt(e[n][0],t))return n;return-1},Xt=Array.prototype,en=Xt.splice;c.prototype.clear=function(){this.__data__=[],this.size=0},c.prototype["delete"]=function(e){var t=this.__data__,n=Yt(t,e);if(0>n)return!1;var o=t.length-1;return n==o?t.pop():en.call(t,n,1),--this.size,!0},c.prototype.get=function(e){var t=this.__data__,n=Yt(t,e);return 0>n?void 0:t[n][1]},c.prototype.has=function(e){return-1<Yt(this.__data__,e)},c.prototype.set=function(e,t){var n=this.__data__,o=Yt(n,e);return 0>o?(++this.size,n.push([e,t])):n[o][1]=t,this};var tn=c,nn=Bt(dt,"Map"),on=nn,rn=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},sn=function(e,t){var n=e.__data__;return rn(t)?n["string"==typeof t?"string":"hash"]:n.map};u.prototype.clear=function(){this.size=0,this.__data__={hash:new Kt,map:new(on||tn),string:new Kt}},u.prototype["delete"]=function(e){var t=sn(this,e)["delete"](e);return this.size-=t?1:0,t},u.prototype.get=function(e){return sn(this,e).get(e)},u.prototype.has=function(e){return sn(this,e).has(e)},u.prototype.set=function(e,t){var n=sn(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this};var an=u;p.Cache=an;var dn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ln=/\\(\\)?/g,cn=function(e){var t=p(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(dn,function(e,n,o,r){t.push(o?r.replace(ln,"$1"):n||e)}),t}),un=function(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r},pn=1/0,hn=ct?ct.prototype:void 0,fn=hn?hn.toString:void 0,mn=function(e){return null==e?"":h(e)},yn=function(e,t){return nt(e)?e:wt(e,t)?[e]:cn(mn(e))},gn=function(e){if("string"==typeof e||xt(e))return e;var t=e+"";return"0"==t&&1/e==-(1/0)?"-0":t},bn=function(e,t){t=yn(t,e);for(var n=0,o=t.length;null!=e&&n<o;)e=e[gn(t[n++])];return n&&n==o?e:void 0},_n=function(e,t,n){var o=null==e?void 0:bn(e,t);return void 0===o?n:o};let kn=r();var jn=f(),xn=function(){if(!arguments.length)return[];var e=arguments[0];return nt(e)?e:[e]},vn=function(e,t,n,o){var r=-1,i=null==e?0:e.length;for(o&&i&&(n=e[++r]);++r<i;)n=t(n,e[r],r,e);return n},On=function(e){return function(t){return null==e?void 0:e[t]}}({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),wn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,An=RegExp("["+("\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff")+"]","g"),Ln=function(e){return e=mn(e),e&&e.replace(wn,On).replace(An,"")},Cn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,En=function(e){return e.match(Cn)||[]},Pn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Sn=function(e){return Pn.test(e)},Tn="\\ud800-\\udfff",zn="\\u2700-\\u27bf",Dn="a-z\\xdf-\\xf6\\xf8-\\xff",Nn="A-Z\\xc0-\\xd6\\xd8-\\xde",In="\\xac\\xb1\\xd7\\xf7"+"\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf"+"\\u2000-\\u206f"+" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Un="['\u2019]",qn="["+In+"]",Rn="\\d+",Mn="["+Dn+"]",Fn="[^"+Tn+In+Rn+zn+Dn+Nn+"]",Hn="(?:\\ud83c[\\udde6-\\uddff]){2}",Bn="[\\ud800-\\udbff][\\udc00-\\udfff]",Vn="["+Nn+"]",Qn="(?:"+Mn+"|"+Fn+")",$n="(?:"+Un+"(?:d|ll|m|re|s|t|ve))?",Gn="(?:"+Un+"(?:D|LL|M|RE|S|T|VE))?",Wn="(?:"+("["+("\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff")+"]")+"|"+"\\ud83c[\\udffb-\\udfff]"+")"+"?",Zn="["+"\\ufe0e\\ufe0f"+"]?",Kn="(?:"+"\\u200d"+"(?:"+["[^"+Tn+"]",Hn,Bn].join("|")+")"+Zn+Wn+")*",Jn="(?:"+["["+zn+"]",Hn,Bn].join("|")+")"+(Zn+Wn+Kn),Yn=RegExp([Vn+"?"+Mn+"+"+$n+"(?="+[qn,Vn,"$"].join("|")+")","(?:"+Vn+"|"+Fn+")"+"+"+Gn+"(?="+[qn,Vn+Qn,"$"].join("|")+")",Vn+"?"+Qn+"+"+$n,Vn+"+"+Gn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rn,Jn].join("|"),"g"),Xn=function(e){return e.match(Yn)||[]},eo=function(e,t,n){return e=mn(e),t=n?void 0:t,void 0===t?Sn(e)?Xn(e):En(e):e.match(t)||[]},to=RegExp("['\u2019]","g"),no=function(e){return function(t){return vn(eo(Ln(t).replace(to,"")),e,"")}}(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),oo=function(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&!1!==t(e[n],n,e););return e},ro=function(e){return function(t,n,o){for(var r,i=-1,s=Object(t),a=o(t),d=a.length;d--&&(r=a[e?d:++i],!1!==n(s[r],r,s)););return t}}(),so=function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o},ao=function(e){return jt(e)&&"[object Arguments]"==kt(e)},lo=Object.prototype,co=lo.hasOwnProperty,uo=lo.propertyIsEnumerable,po=ao(function(){return arguments}())?ao:function(e){return jt(e)&&co.call(e,"callee")&&!uo.call(e,"callee")},ho=po,fo=function(){return!1},mo=i(function(e,t){var n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,r=o&&o.exports===n,i=r?dt.Buffer:void 0,s=i?i.isBuffer:void 0;e.exports=s||fo}),yo=/^(?:0|[1-9]\d*)$/,go=function(e,t){var n=typeof e;return t=null==t?9007199254740991:t,!!t&&("number"==n||"symbol"!=n&&yo.test(e))&&-1<e&&0==e%1&&e<t},bo=function(e){return"number"==typeof e&&-1<e&&0==e%1&&9007199254740991>=e},_o={};_o["[object Float32Array]"]=_o["[object Float64Array]"]=_o["[object Int8Array]"]=_o["[object Int16Array]"]=_o["[object Int32Array]"]=_o["[object Uint8Array]"]=_o["[object Uint8ClampedArray]"]=_o["[object Uint16Array]"]=_o["[object Uint32Array]"]=!0,_o["[object Arguments]"]=_o["[object Array]"]=_o["[object ArrayBuffer]"]=_o["[object Boolean]"]=_o["[object DataView]"]=_o["[object Date]"]=_o["[object Error]"]=_o["[object Function]"]=_o["[object Map]"]=_o["[object Number]"]=_o["[object Object]"]=_o["[object RegExp]"]=_o["[object Set]"]=_o["[object String]"]=_o["[object WeakMap]"]=!1;var ko=i(function(e,t){var n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,r=o&&o.exports===n,i=r&&it.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e?e:i&&i.binding&&i.binding("util")}catch(t){}}();e.exports=s}),jo=ko&&ko.isTypedArray,xo=jo?function(e){return function(t){return e(t)}}(jo):function(e){return jt(e)&&bo(e.length)&&!!_o[kt(e)]},vo=xo,Oo=Object.prototype,wo=Oo.hasOwnProperty,Ao=function(e,t){var n=nt(e),o=!n&&ho(e),r=!n&&!o&&mo(e),i=!n&&!o&&!r&&vo(e),s=n||o||r||i,a=s?so(e.length,String):[],d=a.length;for(var l in e)(t||wo.call(e,l))&&!(s&&("length"==l||r&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||go(l,d)))&&a.push(l);return a},Lo=Object.prototype,Co=function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Lo;return e===n},Eo=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Po=Object.prototype,So=Po.hasOwnProperty,To=function(e){if(!Co(e))return Eo(e);var t=[];for(var n in Object(e))So.call(e,n)&&"constructor"!=n&&t.push(n);return t},zo=function(e){return null!=e&&bo(e.length)&&!Lt(e)},Do=function(e){return zo(e)?Ao(e):To(e)},No=function(e,t){return e&&ro(e,t,Do)},Io=function(e,t){return function(n,o){if(null==n)return n;if(!zo(n))return e(n,o);for(var r=n.length,i=t?r:-1,s=Object(n);(t?i--:++i<r)&&!1!==o(s[i],i,s););return n}}(No),Uo=function(e){return e},qo=function(e){return"function"==typeof e?e:Uo},Ro=function(e,t){var n=nt(e)?oo:Io;return n(e,qo(t))},Mo=function(){try{var e=Bt(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Fo=Mo,Ho=function(e,t,n){"__proto__"==t&&Fo?Fo(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};m.prototype.clear=function(){this.__data__=new tn,this.size=0},m.prototype["delete"]=function(e){var t=this.__data__,n=t["delete"](e);return this.size=t.size,n},m.prototype.get=function(e){return this.__data__.get(e)},m.prototype.has=function(e){return this.__data__.has(e)},m.prototype.set=function(e,t){var n=this.__data__;if(n instanceof tn){var o=n.__data__;if(!on||199>o.length)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new an(o)}return n.set(e,t),this.size=n.size,this};var Bo=m;y.prototype.add=y.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},y.prototype.has=function(e){return this.__data__.has(e)};var Vo=function(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1},Qo=function(e,t){return e.has(t)},$o=function(e,t,n,o,r,i){var s=1&n,a=e.length,d=t.length;if(a!=d&&!(s&&d>a))return!1;var l=i.get(e);if(l&&i.get(t))return l==t;var c=-1,u=!0,p=2&n?new y:void 0;for(i.set(e,t),i.set(t,e);++c<a;){var h=e[c],f=t[c];if(o)var m=s?o(f,h,c,t,e,i):o(h,f,c,e,t,i);if(void 0!==m){if(m)continue;u=!1;break}if(p){if(!Vo(t,function(e,t){if(!Qo(p,t)&&(h===e||r(h,e,n,o,i)))return p.push(t)})){u=!1;break}}else if(!(h===f||r(h,f,n,o,i))){u=!1;break}}return i["delete"](e),i["delete"](t),u},Go=dt.Uint8Array,Wo=Go,Zo=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n},Ko=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n},Jo=ct?ct.prototype:void 0,Yo=Jo?Jo.valueOf:void 0,Xo=function(e,t,n,o,r,i,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!!(e.byteLength==t.byteLength&&i(new Wo(e),new Wo(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Jt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=Zo;case"[object Set]":var d=1&o;if(a||(a=Ko),e.size!=t.size&&!d)return!1;var l=s.get(e);if(l)return l==t;o|=2,s.set(e,t);var c=$o(a(e),a(t),o,r,i,s);return s["delete"](e),c;case"[object Symbol]":if(Yo)return Yo.call(e)==Yo.call(t);}return!1},er=function(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e},tr=function(e,t,n){var o=t(e);return nt(e)?o:er(o,n(e))},nr=function(e,t){for(var n,o=-1,r=null==e?0:e.length,i=0,s=[];++o<r;)n=e[o],t(n,o,e)&&(s[i++]=n);return s},or=Object.prototype,rr=or.propertyIsEnumerable,ir=Object.getOwnPropertySymbols,sr=ir?function(e){return null==e?[]:(e=Object(e),nr(ir(e),function(t){return rr.call(e,t)}))}:function(){return[]},ar=function(e){return tr(e,Do,sr)},dr=Object.prototype,lr=dr.hasOwnProperty,cr=Bt(dt,"DataView"),ur=cr,pr=Bt(dt,"Promise"),hr=pr,fr=Bt(dt,"Set"),mr=fr,yr=Bt(dt,"WeakMap"),gr=yr,br="[object Map]",_r="[object Promise]",kr="[object Set]",jr="[object WeakMap]",xr="[object DataView]",vr=zt(ur),Or=zt(on),wr=zt(hr),Ar=zt(mr),Lr=zt(gr),Cr=kt;(ur&&Cr(new ur(new ArrayBuffer(1)))!=xr||on&&Cr(new on)!=br||hr&&Cr(hr.resolve())!=_r||mr&&Cr(new mr)!=kr||gr&&Cr(new gr)!=jr)&&(Cr=function(e){var t=kt(e),n=t=="[object Object]"?e.constructor:void 0,o=n?zt(n):"";if(o)switch(o){case vr:return xr;case Or:return br;case wr:return _r;case Ar:return kr;case Lr:return jr;}return t});var Er=Cr,Pr=Object.prototype,Sr=Pr.hasOwnProperty,Tr=function(e,t,n,o,r,i){var s=nt(e),a=nt(t),d=s?"[object Array]":Er(e),l=a?"[object Array]":Er(t);d="[object Arguments]"==d?"[object Object]":d,l="[object Arguments]"==l?"[object Object]":l;var c="[object Object]"==d,u="[object Object]"==l,p=d==l;if(p&&mo(e)){if(!mo(t))return!1;s=!0,c=!1}if(p&&!c)return i||(i=new Bo),s||vo(e)?$o(e,t,n,o,r,i):Xo(e,t,d,n,o,r,i);if(!(1&n)){var h=c&&Sr.call(e,"__wrapped__"),f=u&&Sr.call(t,"__wrapped__");if(h||f){var m=h?e.value():e,y=f?t.value():t;return i||(i=new Bo),r(m,y,n,o,i)}}return!!p&&(i||(i=new Bo),g(e,t,n,o,r,i))},zr=b,Dr=function(e){return e===e&&!At(e)},Nr=function(e){for(var t=Do(e),n=t.length;n--;){var o=t[n],r=e[o];t[n]=[o,r,Dr(r)]}return t},Ir=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},Ur=function(e){var t=Nr(e);return 1==t.length&&t[0][2]?Ir(t[0][0],t[0][1]):function(n){return n===e||_(n,e,t)}},qr=function(e,t,n){t=yn(t,e);for(var o,r=-1,i=t.length,s=!1;++r<i&&(o=gn(t[r]),!!(s=null!=e&&n(e,o)));)e=e[o];return s||++r!=i?s:(i=null==e?0:e.length,!!i&&bo(i)&&go(o,i)&&(nt(e)||ho(e)))},Rr=function(e,t){return null!=e&&qr(e,t,k)},Mr=function(e,t){return wt(e)&&Dr(t)?Ir(gn(e),t):function(n){var o=_n(n,e);return void 0===o&&o===t?Rr(n,e):zr(t,o,3)}},Fr=function(e){return function(t){return null==t?void 0:t[e]}},Hr=function(e){return function(t){return bn(t,e)}},Br=function(e){return wt(e)?Fr(gn(e)):Hr(e)},Vr=function(e){return"function"==typeof e?e:null==e?Uo:"object"==typeof e?nt(e)?Mr(e[0],e[1]):Ur(e):Br(e)},Qr=function(e,t){var n={};return t=Vr(t),No(e,function(e,o,r){Ho(n,o,t(e,o,r))}),n};j.prototype=new Error,j.prototype.name="InvalidCharacterError";var $r="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=(e+"").replace(/=+$/,"");if(1==t.length%4)throw new j("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,r=0,i=0,s="";o=t.charAt(i++);~o&&(n=r%4?64*n+o:o,r++%4)?s+=xe(255&n>>(6&-2*r)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s},Gr=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!";}try{return x(t)}catch(e){return $r(t)}};v.prototype=new Error,v.prototype.name="InvalidTokenError";var Wr=function(e,t){if("string"!=typeof e)throw new v("Invalid token specified");t=t||{};var n=!0===t.header?0:1;try{return JSON.parse(Gr(e.split(".")[n]))}catch(t){throw new v("Invalid token specified: "+t.message)}};Wr.InvalidTokenError=v;var Zr;O.prototype=Object.create(null),w.EventEmitter=w,w.usingDomains=!1,w.prototype.domain=void 0,w.prototype._events=void 0,w.prototype._maxListeners=void 0,w.defaultMaxListeners=10,w.init=function(){if(this.domain=null,w.usingDomains&&Zr.active&&!(this instanceof Zr.Domain));this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new O,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},w.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this},w.prototype.getMaxListeners=function(){return A(this)},w.prototype.emit=function(e){var t,n,o,r,s,a,d,l="error"===e;if(a=this._events,a)l=l&&null==a.error;else if(!l)return!1;if(d=this.domain,l){if(t=arguments[1],d)t||(t=new Error("Uncaught, unspecified \"error\" event")),t.domainEmitter=this,t.domain=d,t.domainThrown=!1,d.emit("error",t);else if(t instanceof Error)throw t;else{var c=new Error("Uncaught, unspecified \"error\" event. ("+t+")");throw c.context=t,c}return!1}if(n=a[e],!n)return!1;var u="function"==typeof n;switch(o=arguments.length,o){case 1:L(n,u,this);break;case 2:C(n,u,this,arguments[1]);break;case 3:E(n,u,this,arguments[1],arguments[2]);break;case 4:P(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=Array(o-1),s=1;s<o;s++)r[s-1]=arguments[s];S(n,u,this,r);}return!0},w.prototype.addListener=function(e,t){return T(this,e,t,!1)},w.prototype.on=w.prototype.addListener,w.prototype.prependListener=function(e,t){return T(this,e,t,!0)},w.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,D(this,e,t)),this},w.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,D(this,e,t)),this},w.prototype.removeListener=function(e,t){var n,o,r,s,a;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(o=this._events,!o)return this;if(n=o[e],!n)return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new O:(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length;0<s--;)if(n[s]===t||n[s].listener&&n[s].listener===t){a=n[s].listener,r=s;break}if(0>r)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new O,this;delete o[e]}else I(n,r);o.removeListener&&this.emit("removeListener",e,a||t)}return this},w.prototype.removeAllListeners=function(e){var t,n;if(n=this._events,!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=new O,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new O:delete n[e]),this;if(0===arguments.length){for(var o,r=Object.keys(n),s=0;s<r.length;++s)o=r[s],"removeListener"===o||this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new O,this._eventsCount=0,this}if(t=n[e],"function"==typeof t)this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this},w.prototype.listeners=function(e){var t,n,o=this._events;return o?(t=o[e],n=t?"function"==typeof t?[t.listener||t]:q(t):[]):n=[],n},w.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):N.call(e,t)},w.prototype.listenerCount=N,w.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var Kr=function(e){return R(e)&&!M(e)},Jr="function"==typeof Symbol&&Symbol.for,Yr=Jr?Symbol.for("react.element"):60103;J.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(e,n){return J(e,n,t)},{})};var Xr=/[^\x20-\x7E]/,ei=/[\x2E\u3002\uFF0E\uFF61]/g,ti={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ni=ke,oi=xe,ri=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},ii=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},si={parse:ye,resolve:function(e,t){return ye(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?ye(e,!1,!0).resolveObject(t):t},format:function(e){return de(e)&&(e=ge({},e)),be(e)},Url:me},ai=/^([a-z0-9.+-]+:)/i,di=/:[0-9]*$/,li=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,ci=["{","}","|","\\","^","`"].concat(["<",">","\"","`"," ","\r","\n","\t"]),ui=["'"].concat(ci),pi=["%","/","?",";","#"].concat(ui),hi=["/","?","#"],fi=/^[+a-z0-9A-Z_-]{0,63}$/,mi=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,yi={javascript:!0,"javascript:":!0},gi={javascript:!0,"javascript:":!0},bi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};me.prototype.parse=function(e,t,n){return ge(this,e,t,n)},me.prototype.format=function(){return be(this)},me.prototype.resolve=function(e){return this.resolveObject(ye(e,!1,!0)).format()},me.prototype.resolveObject=function(e){if(de(e)){var t=new me;t.parse(e,!1,!0),e=t}for(var n,o=new me,r=Object.keys(this),a=0;a<r.length;a++)n=r[a],o[n]=this[n];if(o.hash=e.hash,""===e.href)return o.href=o.format(),o;if(e.slashes&&!e.protocol){for(var d,l=Object.keys(e),c=0;c<l.length;c++)d=l[c],"protocol"!==d&&(o[d]=e[d]);return bi[o.protocol]&&o.hostname&&!o.pathname&&(o.path=o.pathname="/"),o.href=o.format(),o}var u;if(e.protocol&&e.protocol!==o.protocol){if(!bi[e.protocol]){for(var h,f=Object.keys(e),m=0;m<f.length;m++)h=f[m],o[h]=e[h];return o.href=o.format(),o}if(o.protocol=e.protocol,!e.host&&!gi[e.protocol]){for(u=(e.pathname||"").split("/");u.length&&!(e.host=u.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==u[0]&&u.unshift(""),2>u.length&&u.unshift(""),o.pathname=u.join("/")}else o.pathname=e.pathname;if(o.search=e.search,o.query=e.query,o.host=e.host||"",o.auth=e.auth,o.hostname=e.hostname||e.host,o.port=e.port,o.pathname||o.search){var y=o.pathname||"",p=o.search||"";o.path=y+p}return o.slashes=o.slashes||e.slashes,o.href=o.format(),o}var s=o.pathname&&"/"===o.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=g||s||o.host&&e.pathname,_=b,j=o.pathname&&o.pathname.split("/")||[],x=o.protocol&&!bi[o.protocol];u=e.pathname&&e.pathname.split("/")||[],x&&(o.hostname="",o.port=null,o.host&&(""===j[0]?j[0]=o.host:j.unshift(o.host)),o.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===u[0]?u[0]=e.host:u.unshift(e.host)),e.host=null),b=b&&(""===u[0]||""===j[0]));var O;if(g)o.host=e.host||""===e.host?e.host:o.host,o.hostname=e.hostname||""===e.hostname?e.hostname:o.hostname,o.search=e.search,o.query=e.query,j=u;else if(u.length)j||(j=[]),j.pop(),j=j.concat(u),o.search=e.search,o.query=e.query;else if(!ae(e.search))return x&&(o.hostname=o.host=j.shift(),O=!!(o.host&&0<o.host.indexOf("@"))&&o.host.split("@"),O&&(o.auth=O.shift(),o.host=o.hostname=O.shift())),o.search=e.search,o.query=e.query,se(o.pathname)&&se(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=o.format(),o;if(!j.length)return o.pathname=null,o.path=o.search?"/"+o.search:null,o.href=o.format(),o;for(var w=j.slice(-1)[0],A=(o.host||e.host||1<j.length)&&("."===w||".."===w)||""===w,L=0,C=j.length;0<=C;C--)w=j[C],"."===w?j.splice(C,1):".."===w?(j.splice(C,1),L++):L&&(j.splice(C,1),L--);if(!b&&!_)for(;L--;L)j.unshift("..");b&&""!==j[0]&&(!j[0]||"/"!==j[0].charAt(0))&&j.unshift(""),A&&"/"!==j.join("/").substr(-1)&&j.push("");var E=""===j[0]||j[0]&&"/"===j[0].charAt(0);return x&&(o.hostname=o.host=E?"":j.length?j.shift():"",O=!!(o.host&&0<o.host.indexOf("@"))&&o.host.split("@"),O&&(o.auth=O.shift(),o.host=o.hostname=O.shift())),b=b||o.host&&j.length,b&&!E&&j.unshift(""),j.length?o.pathname=j.join("/"):(o.pathname=null,o.path=null),se(o.pathname)&&se(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.auth=e.auth||o.auth,o.slashes=o.slashes||e.slashes,o.href=o.format(),o},me.prototype.parseHost=function(){return _e(this)},Promise.each=async function(e,t){for(const n of e)await t(n)};let _i,ki=r();e.debug=!1;const ji={autoConnect:!0};class xi extends w{constructor(t,n={}){super(),n=J.all([n,ji,n]);const{protocol:o,host:r,pathname:i}=si.parse(t);this._options=n,this._token=null,this._isConnected=!1,this._isConnecting=!1,this._connectedAuth=null,this._host=`${o}//${r}`,this._path=`${i}-socket`,this._socketId=null,this._socket=null,this._binds={error:this._error.bind(this),connect:this._connect.bind(this),disconnect:this._disconnect.bind(this),create:this._proxySocket.bind(this,"create"),update:this._proxySocket.bind(this,"update"),delete:this._proxySocket.bind(this,"delete"),"*":(t,n)=>{e.debug&&console.log(`emit all`,{event:t,payload:n}),this.emit("*",t,n)}},this._options.autoConnect&&this.connect()}connect(){if(this._connectedAuth===this.token&&(this._isConnected||this._isConnecting))return;this._isConnecting=!0,this._isConnected=!1,this._connectedAuth=this.token;const t=Object.assign({forceNew:!0,path:this._path},this.token?{transportOptions:{polling:{extraHeaders:{Authorization:`Bearer ${this.token}`}}}}:{});this._socket&&(e.debug&&this._socketId&&console.log(`disconnecting from ${this._socketId}`),this._unwireSocket(),this._socket.disconnect(!0)),e.debug&&console.log(`connecting ${this.token?"with":"without"} credentials`);const n=o(this._host,t);e.debug&&(n.on("connect",()=>{this._socket===n?(this._socketId=n.id,e.debug&&console.log(`@pleasure-js/api-client connected with id ${n.id}`)):e.debug&&console.log(`BEWARE! @pleasure-js/api-client connected with id ${n.id} but not the main driver`)}),n.on("disconnect",t=>{e.debug&&console.log(`@pleasure-js/api-client disconnected due to ${t}`)}),n.on("reconnecting",t=>{e.debug&&console.log(`@pleasure-js/api-client reconnecting attempt # ${t}`)})),n.onevent=xi._onEvent(n.onevent),this._socket=n,this._wireSocket()}static _onEvent(t){return function(n){e.debug&&console.log(`receiving packet ${n}`);const o=n.data||[];t.call(this,n),n.data=["*"].concat(o),t.call(this,n)}}static queryParamEncode(e){return Qr(e,e=>Array.isArray(e)?e:e instanceof RegExp?{$regex:e.source,$options:e.flags}:"object"==typeof e?vi.queryParamEncode(e):JSON.stringify(e))}_wiring(e,t=!0,n){e.forEach(e=>{this._socket[t?"on":"off"](e,n||this._binds[e])})}_unwireSocket(){this._wiring(Object.keys(this._binds),!1),this._socket.removeAllListeners()}_wireSocket(){this._wiring(Object.keys(this._binds))}_proxySocket(t,n){e.debug&&console.log(`proxy socket`,{method:t,payload:n}),this.emit(t,n)}_error(...e){this._isConnecting=!1,this.emit("error",...e)}_connect(){e.debug&&console.log(`connected ${this._socket.id}`),this._isConnected=!0,this._isConnecting=!1,this.emit("connect")}_disconnect(t){e.debug&&console.log(`disconnected ${this._socket.id}`),this._isConnected=!1,this.emit("disconnect")}get socket(){return this._socket}get token(){return this._token}set token(e){return this._token=e,this.connect(),e}}class vi extends xi{constructor(t){const{accessToken:o,refreshToken:r,driver:i=f(),config:s=ki,reduxOptions:a={}}=t||{};e.debug&&console.log(`initializing @pleasure-js/api-client`,{reduxOptions:a});const{baseURL:d}=i.defaults;super(d,a),this._driver=i,this._userProfile=null,this._daemonSessionExpired=null,this._cache=[],this.config=s,this.setCredentials({accessToken:o,refreshToken:r});const l=e=>{const t={};return(o,...r)=>{const i=n({name:o,args:r});return t[i]?t[i]:t[i]=e(o,...r)}},c=l(e=>{const t={get(t,n){return n in t?t[n].bind(t,e):"toJSON"===n?void 0:t.controller.bind(t,e,no(n))}};return new Proxy(this,t)}),u=l((e,t)=>{function n(n,{entity:o,entry:r}){e!==o||xn(r).forEach(e=>{e._id===t&&n(e)})}function o(e){let t;return Ro(r,({cb:n,bind:o})=>{if(n===e)return t=o,!1}),t||(t=n.bind(null,e),r.push({cb:e,bind:t})),t}const r=[],i={get(n,r){return /^(on|off|once|emit)$/.test(r)?(e,t)=>{n[r](e,o(t))}:r in n?n[r].bind(n,e,t):void 0},apply(){}};return new Proxy(this,i)}),p={get(e,t){const n=t;return"string"!=typeof n||n in e?e[t]:new Proxy(()=>{},{get(e,t){return c(n)[t]},apply:function(e,t,o){return u(n,...o)}})}};return new Proxy(this,p)}static debug(t){e.debug=!!t}setCredentials({accessToken:e=null,refreshToken:t=null}={}){this._accessToken=e,this._refreshToken=t,this._refreshCredentials()}async proxyCacheReq({id:e,req:t}){let n;return await Promise.each(this._cache,async o=>{if(n=await o.req({id:e,req:t}),"undefined"!=typeof n)return!1}),n}async proxyCacheRes({id:e,req:t,res:n}){return await Promise.each(this._cache,async o=>{await o.res({id:e,req:t,res:n})}),n}async driver(t={}){const o=n(t),r=await this.proxyCacheReq({id:o,req:t});if(t.params&&(t.params=vi.queryParamEncode(t.params)),"undefined"!=typeof r)return r;e.debug&&console.log(`@pleasure-js/api-client calling>`,{req:t},`${this.accessToken?"with auth":" without auth"}`);const i=await this._driver(t);return this.proxyCacheRes({id:o,req:t,res:i}).catch(e=>{console.log(`Proxy cache res error:`,e)}),i}cache(e){this._cache.push(e)}_localLogout(){if(this._accessToken){const e=this.userProfile;this.setCredentials(),this.emit("logout",e)}}_sessionBeat(){var e=Math.max,t=Math.round;return clearTimeout(this._daemonSessionExpired),this.accessToken&&this.userProfile&&!(this.userProfile.sessionExpires<=Date.now())?void(this._daemonSessionExpired=setTimeout(this._sessionBeat.bind(this),e(t(.75*(this.userProfile.sessionExpires-Date.now()))),1e3)):this._localLogout()}_refreshCredentials(){return this.token=this._accessToken,this._userProfile=this._accessToken?Wr(this._accessToken):null,this._sessionBeat(),this._accessToken?void(this._driver.defaults.headers.common.Authorization=`Bearer ${this._accessToken}`,this.emit("login",this.userProfile)):void delete this._driver.defaults.headers.common.Authorization}get userProfile(){return this._userProfile}getSessionProfile(){return this._accessToken?Wr(this._accessToken):null}async login(e,t={}){this._localLogout();const{accessToken:n,refreshToken:o}=await this.driver({url:`${this.config.authEndpoint}`,method:"post",data:e,params:t});return this.setCredentials({accessToken:n,refreshToken:o}),{accessToken:n,refreshToken:o}}async me(){if(this._accessToken)return await this._driver({url:`${this.config.revokeEndpoint}`,method:"post"}),this._localLogout()}get accessToken(){return this._accessToken}async logout(){return await this._driver({url:`${this.config.revokeEndpoint}`,method:"post"}),this._localLogout()}create(e,t,n={}){if(!e||!t)throw new Error(`Provide both entity and entry`);return this.driver({url:`/${e}`,data:t,method:"post",params:n})}getEntities(){return this.driver({url:this.config.entitiesUri})}read(e,t,n,o={}){if(!e||!t)throw new Error(`Provide both entity and id`);const r=[e,t,n].filter(e=>!!e).join("/");return this.driver({url:`/${r}`,params:o})}update(e,t,n,o){if(!e||!t)throw new Error(`Provide both entity and id`);return this.driver({url:`/${e}/${t}`,method:"patch",data:n,params:o})}list(e,t={},n={}){if(!e)throw new Error(`Provide an entity`);return this.driver({url:`/${e}`,params:Object.assign({},n,t)})}delete(e,t,n={}){let o=`/${e}`;return"object"==typeof t&&(Object.assign(n,{id:Array.isArray(t)?xn(t):t}),t=null),t&&(o+=`/${t}`),this.driver({url:o,method:"delete",params:n})}push(e,t,n,o,r=!1,i={}){if(!e||!t||!n||!o)throw Error(`Provide all 'entity', 'id', 'fieldPath' and 'newEntry'.`);return this.driver({url:`${e}/${t}/${n}`,method:"post",data:{push:o,multiple:r},params:i})}controller(e,t,n=null,o){if(!e||!t)throw Error(`Provide both 'entity' and 'controller'.`);return this.driver({url:`${e}/${t}`,method:null===n?"get":"post",data:n,params:o})}pull(e,t,n,o,r={}){if(!e||!t||!n||!o)throw Error(`Provide all 'entity', 'id', 'fieldPath' and 'pull'.`);return this.driver({url:`${e}/${t}/${n}`,method:"delete",params:Object.assign({},r,{pull:o})})}static instance(t){if(e.debug&&console.log(`pleasure-client-instance`,{opts:t}),_i){if(t)throw new Error(`Opts not accepted since singleton instance is already initialized.`);return _i}return _i=new vi(t),_i}}const Oi=vi.instance.bind(vi);return e.ApiClient=vi,e.ApiError=ve,e.apiDriver=jn,e.config=kn,e.defaultReduxOptions=ji,e.getConfig=r,e.getDriver=f,e.instance=Oi,e}({},axios,objectHash,io);
